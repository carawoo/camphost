@startuml
' ==============================================================================
' [Level 3] Component - sample-domain Package
' ==============================================================================
' Package: @pioncorp/sample-domain
' Description: sample-domain íŒ¨í‚¤ì§€ ë‚´ë¶€ì˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸
'
' ğŸ”— ì½”ë“œ ê²½ë¡œ:
'    â€¢ packages/sample-domain/src/
'    â€¢ packages/sample-domain/src/user/
'    â€¢ packages/sample-domain/src/notification/
'    â€¢ packages/sample-domain/src/file-storage/
'
' ğŸ”„ ë™ê¸°í™” ê·œì¹™:
'    âœ… lv2 (overview.puml) - sample-domain ì»¨í…Œì´ë„ˆ ì„¤ëª… í™•ì¸
'    âœ… lv4 (user-service.puml, notification-*.puml) ë³€ê²½ ì‹œ ì´ ë‹¤ì´ì–´ê·¸ë¨ í™•ì¸
'    âœ… ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸(Service/Provider) ì¶”ê°€ ì‹œ ì´ ë‹¤ì´ì–´ê·¸ë¨ ì—…ë°ì´íŠ¸
'
' ğŸ“ ë³€ê²½ ëŒ€ìƒ:
'    â€¢ Component - Service/Provider ì¶”ê°€/ì œê±°
'    â€¢ Rel - ì»´í¬ë„ŒíŠ¸ ê°„ ê´€ê³„ ë³€ê²½
'    â€¢ ComponentDb - ìŠ¤í† ë¦¬ì§€ ì¶”ê°€/ì œê±°
'
' ğŸ” ë“œë¦´ë‹¤ìš´:
'    â€¢ User Management â†’ ../lv4-code/sample-domain/user.service.puml
'    â€¢ Notification Management â†’ ../lv4-code/sample-domain/notification.service.puml
'    â€¢ File Storage Management â†’ ../lv4-code/sample-domain/file-storage.service.puml
'
' â¬†ï¸  Zoom Out: ../lv2-containers/overview.puml
' ==============================================================================

!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

LAYOUT_WITH_LEGEND()

title [Level 3] Component - sample-domain Package

Container_Boundary(sample_domain, "@pioncorp/sample-domain") {

    ' ========== User Management Components ==========
    Component(user_component, "User Management", "Component", "ì‚¬ìš©ì CRUD ê´€ë¦¬\n- ì‚¬ìš©ì ìƒì„±/ì¡°íšŒ/ìˆ˜ì •/ì‚­ì œ\n- In-Memory ì €ì¥")

    ' ========== File Storage Components ==========
    Component(file_storage_component, "File Storage Management", "Component", "ê°œì¸ íŒŒì¼ ìŠ¤í† ë¦¬ì§€\n- ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ/ëª©ë¡/ìˆ˜ì •/ì‚­ì œ\n- In-Memory ì €ì¥\n- íŒŒì¼ í¬ê¸°/íƒ€ì… ê²€ì¦\n- ê¶Œí•œ ê´€ë¦¬")

    ' ========== Notification Components ==========
    Component(notification_component, "Notification Management", "Component", "ë©€í‹°ì±„ë„ ì•Œë¦¼ ë°œì†¡\n- ì±„ë„: Email, SMS, Push, Kakao\n- Strategy Pattern ì ìš©")

    Component(provider_strategy, "Provider Strategy", "Component", "ì•Œë¦¼ Provider ì¶”ìƒí™”\n- EmailProvider\n- SmsProvider\n- PushProvider\n- KakaoProvider")

    Component(console_providers, "Console Providers", "Component", "ê°œë°œ/í…ŒìŠ¤íŠ¸ìš© Provider\n- console.log ì¶œë ¥\n- ì‹¤ì œ ë°œì†¡ ì—†ìŒ")

    Component(production_providers, "Production Providers", "Component", "í”„ë¡œë•ì…˜ìš© Provider\n- AWS SES (Email)\n- Twilio (SMS)\n- FCM (Push)\n- Kakao Talk API")

    ' ========== Storage Components ==========
    ComponentDb(user_store, "User Store", "In-Memory Map", "ì‚¬ìš©ì ë°ì´í„° ì„ì‹œ ì €ì¥\nMap<string, User>")

    ComponentDb(file_store, "File Store", "In-Memory Map", "íŒŒì¼ ë°ì´í„° ì„ì‹œ ì €ì¥\nMap<string, StoredFile>")

    ' ========== Shared Components ==========
    Component(di_registry, "DI Registry", "tsyringe", "ì˜ì¡´ì„± ì£¼ì… ë ˆì§€ìŠ¤íŠ¸ë¦¬\n- Singleton ê´€ë¦¬\n- ìƒëª…ì£¼ê¸° ê´€ë¦¬")
}

Container_Ext(shared_core, "shared-core", "Logger, Types")

System_Ext(email_api, "Email Service API")
System_Ext(sms_api, "SMS Service API")
System_Ext(push_api, "Push Service API")
System_Ext(kakao_api, "Kakao Service API")

' ========== Relationships ==========

' User Component
Rel(user_component, user_store, "CRUD ì‘ì—…", "In-Memory")
Rel(user_component, shared_core, "ë¡œê¹…", "Logger")
Rel(user_component, di_registry, "ë“±ë¡/í•´ì†Œ", "Singleton")

' File Storage Component
Rel(file_storage_component, file_store, "CRUD ì‘ì—…", "In-Memory")
Rel(file_storage_component, shared_core, "ë¡œê¹…", "Logger")
Rel(file_storage_component, di_registry, "ë“±ë¡/í•´ì†Œ", "Singleton")

' Notification Component
Rel(notification_component, provider_strategy, "ì•Œë¦¼ ë°œì†¡ ìœ„ì„", "Strategy Pattern")
Rel(notification_component, shared_core, "ë¡œê¹…", "Logger")
Rel(notification_component, di_registry, "ë“±ë¡/í•´ì†Œ", "Singleton")

' Provider Strategy
Rel(provider_strategy, console_providers, "ê°œë°œ í™˜ê²½", "Runtime Selection")
Rel(provider_strategy, production_providers, "í”„ë¡œë•ì…˜ í™˜ê²½", "Runtime Selection")

' Providers to External APIs
Rel(production_providers, email_api, "ì´ë©”ì¼ ë°œì†¡", "HTTPS/REST")
Rel(production_providers, sms_api, "SMS ë°œì†¡", "HTTPS/REST")
Rel(production_providers, push_api, "í‘¸ì‹œ ë°œì†¡", "HTTPS/REST")
Rel(production_providers, kakao_api, "ì•Œë¦¼í†¡ ë°œì†¡", "HTTPS/REST")

' DI Registry
Rel(di_registry, console_providers, "Injectable ë“±ë¡", "Decorator")
Rel(di_registry, production_providers, "Injectable ë“±ë¡", "Decorator")

SHOW_LEGEND()

note right of notification_component
  <b>Strategy Pattern</b>
  â€¢ ëŸ°íƒ€ì„ì— Provider êµì²´ ê°€ëŠ¥
  â€¢ í™˜ê²½ë³„ êµ¬í˜„ì²´ ì „í™˜ (Dev/Prod)
  â€¢ í…ŒìŠ¤íŠ¸ ìš©ì´ì„± (Mock Provider)

  <b>ğŸ” Drill Down</b>
  â†’ ../lv4-code/sample-domain/notification-service.puml
  â†’ ../lv4-code/sample-domain/notification-providers.puml
end note

note bottom of user_component
  <b>ğŸ” Drill Down</b>
  â†’ ../lv4-code/sample-domain/user.service.puml

  <b>ì£¼ìš” í´ë˜ìŠ¤</b>
  â€¢ UserService í´ë˜ìŠ¤
  â€¢ User ì¸í„°í˜ì´ìŠ¤
  â€¢ CreateUserInput DTO
end note

note bottom of file_storage_component
  <b>ğŸ” Drill Down</b>
  â†’ ../lv4-code/sample-domain/file-storage.service.puml

  <b>ì£¼ìš” í´ë˜ìŠ¤</b>
  â€¢ FileStorageService í´ë˜ìŠ¤
  â€¢ FileMetadata ì¸í„°í˜ì´ìŠ¤
  â€¢ UploadFileInput DTO

  <b>ë³´ì•ˆ ê¸°ëŠ¥</b>
  â€¢ íŒŒì¼ í¬ê¸° ì œí•œ (10MB)
  â€¢ MIME íƒ€ì… ê²€ì¦
  â€¢ ì‚¬ìš©ìë³„ ê¶Œí•œ ê´€ë¦¬
end note

note as SyncGuide #FFE0E0
  <b>âš ï¸  ë™ê¸°í™” ì²´í¬ë¦¬ìŠ¤íŠ¸</b>
  ====
  ì´ ë‹¤ì´ì–´ê·¸ë¨ ë³€ê²½ ì‹œ:

  â˜ lv4 ë‹¤ì´ì–´ê·¸ë¨ ë³€ê²½ ë°˜ì˜ë¨?
     â€¢ user.service.puml
     â€¢ notification.service.puml
     â€¢ file-storage.service.puml

  â˜ ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ ì‹œ
     â†’ Component ì¶”ê°€
     â†’ lv2 (overview.puml) ì„¤ëª… ì—…ë°ì´íŠ¸
     â†’ lv4 ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±

  â˜ ì™¸ë¶€ API ì¶”ê°€/ì œê±° ì‹œ
     â†’ System_Ext ì¶”ê°€/ì œê±°
     â†’ lv2, lv1 ë™ê¸°í™” í™•ì¸
end note

@enduml
