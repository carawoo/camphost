@startuml CampHost API Components
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

' ============================================================================
' Level 3: API Component Diagram
' ============================================================================
'
' REST API Container ë‚´ë¶€ì˜ ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì»´í¬ë„ŒíŠ¸ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.
' - Admin Login API (ê´€ë¦¬ì ì¸ì¦)
' - Checkin Notification API (ì²´í¬ì¸ ì•Œë¦¼)
' - Email APIs (ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •, íšŒì›ì •ë³´ ë¬¸ì˜)
' - Dev Tools API (ê°œë°œ ìœ í‹¸ë¦¬í‹°)
'
' ğŸ”— ì´ì „ ë ˆë²¨: lv2-containers/overview.puml
' ğŸ”— ë‹¤ìŒ ë ˆë²¨: lv4-code/**/*.puml
' ============================================================================

LAYOUT_WITH_LEGEND()

title Component Diagram for CampHost REST API

' ============================================================================
' Actors (ì‚¬ìš©ì)
' ============================================================================

Person(campgroundAdmin, "Campground Admin", "ìº í•‘ì¥ ì‚¬ì¥ë‹˜")
Person(camper, "Camper", "ìº í•‘ ê³ ê°")
Person(developer, "Developer", "ê°œë°œì")

' ============================================================================
' System Boundary
' ============================================================================

System_Boundary(camphost, "CampHost") {

    ' ------------------------------------------------------------------------
    ' Container: REST API
    ' ------------------------------------------------------------------------
    Container_Boundary(api, "REST API") {

        ' --------------------------------------------------------------------
        ' Admin Login API
        ' --------------------------------------------------------------------
        Component(adminLoginAPI, "Admin Login API", "Next.js API Route", "ê´€ë¦¬ì ë¡œê·¸ì¸ ì¸ì¦\n\n**ì—”ë“œí¬ì¸íŠ¸:**\nPOST /api/admin/login\n\n**ê¸°ëŠ¥:**\n- Supabase ìº í•‘ì¥ ì¡°íšŒ\n- ë¹„ë°€ë²ˆí˜¸ ê²€ì¦\n- ì‚­ì œëœ ìº í•‘ì¥ ì°¨ë‹¨\n- í´ë°±: í•˜ë“œì½”ë”© credential\n\nğŸ”— app/api/admin/login/route.ts")

        ' --------------------------------------------------------------------
        ' Checkin Notification API
        ' --------------------------------------------------------------------
        Component(checkinNotificationAPI, "Checkin Notification API", "Next.js API Route", "ì²´í¬ì¸ ì•Œë¦¼ ì´ë©”ì¼ ë°œì†¡\n\n**ì—”ë“œí¬ì¸íŠ¸:**\nPOST /api/notify/checkin\n\n**ê¸°ëŠ¥:**\n- ì²´í¬ì¸ ì •ë³´ ìˆ˜ì‹ \n- Resend ì´ë©”ì¼ ë°œì†¡\n- ìº í•‘ì¥ ì‚¬ì¥ë‹˜ ì•Œë¦¼\n\n**í™˜ê²½ ë³€ìˆ˜:**\n- RESEND_API_KEY\n- NOTIFY_EMAIL\n\nğŸ”— app/api/notify/checkin/route.ts")

        ' --------------------------------------------------------------------
        ' Reset Password Email API
        ' --------------------------------------------------------------------
        Component(resetPasswordEmailAPI, "Reset Password Email API", "Next.js API Route", "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ìš”ì²­ ì´ë©”ì¼\n\n**ì—”ë“œí¬ì¸íŠ¸:**\nPOST /api/admin/reset-email\n\n**ê¸°ëŠ¥:**\n- ì¬ì„¤ì • ìš”ì²­ ì •ë³´ ìˆ˜ì‹ \n- HTML í…œí”Œë¦¿ ì´ë©”ì¼ ë°œì†¡\n- ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼\n\nğŸ”— app/api/admin/reset-email/route.ts")

        ' --------------------------------------------------------------------
        ' Help Email API
        ' --------------------------------------------------------------------
        Component(helpEmailAPI, "Help Email API", "Next.js API Route", "íšŒì›ì •ë³´ ë¬¸ì˜ ì´ë©”ì¼\n\n**ì—”ë“œí¬ì¸íŠ¸:**\nPOST /api/admin/help-email\n\n**ê¸°ëŠ¥:**\n- ë¬¸ì˜ ì •ë³´ ìˆ˜ì‹ \n- HTML í…œí”Œë¦¿ ì´ë©”ì¼ ë°œì†¡\n- ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼\n\nğŸ”— app/api/admin/help-email/route.ts")

        ' --------------------------------------------------------------------
        ' Dev Tools API
        ' --------------------------------------------------------------------
        Component(devToolsAPI, "Dev Tools API", "Next.js API Route", "ê°œë°œ ìœ í‹¸ë¦¬í‹° API\n\n**ì—”ë“œí¬ì¸íŠ¸:**\nGET /api/dev/seed-reservation\nGET /api/dev/cascade-delete\n\n**ê¸°ëŠ¥:**\n- í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±\n- ìºìŠ¤ì¼€ì´ë“œ ì‚­ì œ\n- Supabase CRUD\n\nğŸ”— app/api/dev/seed-reservation/route.ts\nğŸ”— app/api/dev/cascade-delete/route.ts")

    }

}

' ============================================================================
' External Systems (ì™¸ë¶€ ì‹œìŠ¤í…œ)
' ============================================================================

System_Ext(supabase, "Supabase", "PostgreSQL ë°ì´í„°ë² ì´ìŠ¤\n\n**í…Œì´ë¸”:**\n- campgrounds (ìº í•‘ì¥)\n- reservations (ì˜ˆì•½)\n- inquiries (ë¬¸ì˜)")

System_Ext(resend, "Resend", "ì´ë©”ì¼ ë°œì†¡ ì„œë¹„ìŠ¤\n\n**ì´ë©”ì¼ ì¢…ë¥˜:**\n- ì²´í¬ì¸ ì•Œë¦¼\n- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •\n- íšŒì›ì •ë³´ ë¬¸ì˜")

' ============================================================================
' Relationships (ê´€ê³„)
' ============================================================================

' Users â†’ API Components
Rel(campgroundAdmin, adminLoginAPI, "ë¡œê·¸ì¸ ìš”ì²­", "POST /api/admin/login\nJSON body")
Rel(camper, checkinNotificationAPI, "ì²´í¬ì¸ ì•Œë¦¼ ì „ì†¡", "POST /api/notify/checkin\nJSON body")
Rel(campgroundAdmin, resetPasswordEmailAPI, "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ìš”ì²­", "POST /api/admin/reset-email\nJSON body")
Rel(campgroundAdmin, helpEmailAPI, "ë¬¸ì˜ ì ‘ìˆ˜", "POST /api/admin/help-email\nJSON body")
Rel(developer, devToolsAPI, "ê°œë°œ ë„êµ¬ ì‚¬ìš©", "GET /api/dev/*\nQuery params")

' API Components â†’ External Systems
Rel(adminLoginAPI, supabase, "ìº í•‘ì¥ ì¡°íšŒ ë° ì¸ì¦", "REST API\nSELECT campgrounds")
Rel(devToolsAPI, supabase, "CRUD ì‘ì—…", "REST API\nINSERT, DELETE")

Rel(checkinNotificationAPI, resend, "ì²´í¬ì¸ ì•Œë¦¼ ë°œì†¡", "POST /emails\nPlain text")
Rel(resetPasswordEmailAPI, resend, "ì¬ì„¤ì • ì´ë©”ì¼ ë°œì†¡", "POST /emails\nHTML template")
Rel(helpEmailAPI, resend, "ë¬¸ì˜ ì´ë©”ì¼ ë°œì†¡", "POST /emails\nHTML template")

' ============================================================================
' Notes
' ============================================================================

note right of adminLoginAPI
  **ì¸ì¦ í”„ë¡œì„¸ìŠ¤:**
  1. Request body íŒŒì‹±
  2. Supabase ìº í•‘ì¥ ì¡°íšŒ
  3. ìƒíƒœ í™•ì¸ (terminated ì°¨ë‹¨)
  4. ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
  5. í† í° ìƒì„± ë° ë°˜í™˜

  **í´ë°± ë¡œì§:**
  - Supabase ì‹¤íŒ¨ ì‹œ í•˜ë“œì½”ë”©ëœ
    credential ëª©ë¡ ì‚¬ìš©
  - 'í…ŒìŠ¤íŠ¸ìº í•‘ì¥', 'ì˜¤ë„ì´ì´Œ' ë“±
end note

note right of checkinNotificationAPI
  **ì´ë©”ì¼ ë‚´ìš©:**
  - ìº í•‘ì¥ëª…, ê³ ê°ëª…, ì—°ë½ì²˜
  - ê°ì‹¤ ë²ˆí˜¸, ì²´í¬ì¸/ì•„ì›ƒ ë‚ ì§œ
  - ì¸ì› ìˆ˜, ê²°ì œ ê¸ˆì•¡
  - ìº í•‘ì¥ ì‚¬ì¥ë‹˜ ì—°ë½ì²˜

  **ìˆ˜ì‹ ì:**
  - NOTIFY_EMAIL í™˜ê²½ ë³€ìˆ˜
  - ê¸°ë³¸ê°’: odoichon@odoichon.com
end note

note bottom of devToolsAPI
  **ê°œë°œ ì „ìš© API** (Productionì—ì„œ ë¹„í™œì„±í™” ê¶Œì¥)

  **seed-reservation:**
  - í…ŒìŠ¤íŠ¸ ìº í•‘ì¥ ìƒì„± (ì—†ìœ¼ë©´)
  - í…ŒìŠ¤íŠ¸ ì˜ˆì•½ ë°ì´í„° ìƒì„±
  - Kiosk URL, Admin URL ë°˜í™˜

  **cascade-delete:**
  - ìº í•‘ì¥ IDë¡œ ì‚­ì œ
  - ì—°ê´€ëœ ì˜ˆì•½, ë¬¸ì˜ ëª¨ë‘ ì‚­ì œ
  - Best-effort (ì—ëŸ¬ ë¬´ì‹œ)
end note

' ============================================================================
' ë™ê¸°í™” ì²´í¬ë¦¬ìŠ¤íŠ¸
' ============================================================================
'
' â–¡ ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ì‹œ
'   - Component(...) ì¶”ê°€
'   - Rel(...) ê´€ê³„ ì •ì˜
'   - ğŸ”— ì½”ë“œ ê²½ë¡œ ì£¼ì„ ì¶”ê°€
'
' â–¡ API ê¸°ëŠ¥ ë³€ê²½ ì‹œ
'   - Component ì„¤ëª… ì—…ë°ì´íŠ¸
'   - Rel ê´€ê³„ ìˆ˜ì • (í•„ìš”ì‹œ)
'
' â–¡ ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ë™ ë³€ê²½ ì‹œ
'   - System_Ext(...) í™•ì¸
'   - Rel(API, ì™¸ë¶€ì„œë¹„ìŠ¤, ...) ìˆ˜ì •
'
' â–¡ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€/ë³€ê²½ ì‹œ
'   - Component ì„¤ëª…ì— í™˜ê²½ ë³€ìˆ˜ ëª…ì‹œ
'

@enduml
