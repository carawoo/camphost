@startuml CampHost Container Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

' ============================================================================
' Level 2: Container Diagram
' ============================================================================
'
' CampHost 시스템 내부의 주요 컨테이너(실행 단위)를 표현합니다.
' - Web Application (Next.js)
' - REST API (Next.js API Routes)
' - Browser Storage (localStorage)
' - 외부 시스템과의 관계
'
' 🔗 이전 레벨: lv1-system-context/system.puml
' 🔗 다음 레벨: lv3-components/*.puml
' ============================================================================

LAYOUT_WITH_LEGEND()

title Container Diagram for CampHost

' ============================================================================
' Actors (사용자)
' ============================================================================

Person(superAdmin, "Super Admin", "시스템 전체 관리자")
Person(campgroundAdmin, "Campground Admin", "캠핑장 사장님")
Person(camper, "Camper", "캠핑 고객")

' ============================================================================
' System Boundary
' ============================================================================

System_Boundary(camphost, "CampHost") {

    ' ------------------------------------------------------------------------
    ' Web Application
    ' ------------------------------------------------------------------------
    Container(webapp, "Web Application", "Next.js 14.2, React 18, TypeScript", "사용자 인터페이스 제공\n\n**주요 페이지:**\n- / (랜딩)\n- /super-admin/dashboard\n- /admin/* (대시보드, 예약, 매출)\n- /kiosk (체크인/체크아웃)\n\n**렌더링:**\n- SSR (Server-Side Rendering)\n- SSG (Static Site Generation)\n- CSR (Client-Side Rendering)")

    ' ------------------------------------------------------------------------
    ' REST API
    ' ------------------------------------------------------------------------
    Container(api, "REST API", "Next.js API Routes, Node.js", "비즈니스 로직 및 외부 서비스 통합\n\n**주요 엔드포인트:**\n- POST /api/admin/login\n- POST /api/notify/checkin\n- GET/POST /api/dev/*\n\n**역할:**\n- 인증 및 권한 검증\n- Supabase 데이터 접근\n- Resend 이메일 발송")

    ' ------------------------------------------------------------------------
    ' Browser Storage
    ' ------------------------------------------------------------------------
    ContainerDb(localStorage, "Browser Storage", "localStorage", "오프라인 지원 및 데이터 캐싱\n\n**저장 데이터:**\n- 캠핑장 목록\n- 예약 정보 (폴백)\n- 사용자 세션\n\n**사용 시점:**\n- 오프라인 모드\n- 네트워크 장애 시")

}

' ============================================================================
' External Systems (외부 시스템)
' ============================================================================

System_Ext(supabase, "Supabase", "PostgreSQL 데이터베이스\n\n**테이블:**\n- campgrounds\n- reservations\n- inquiries\n- dashboard_metrics (view)")

System_Ext(resend, "Resend", "이메일 발송 서비스\n\n**이메일 종류:**\n- 체크인 알림\n- 관리자 알림")

' ============================================================================
' Relationships (관계)
' ============================================================================

' Users → Web Application
Rel(superAdmin, webapp, "캠핑장 관리", "HTTPS\n브라우저")
Rel(campgroundAdmin, webapp, "예약 관리", "HTTPS\n브라우저")
Rel(camper, webapp, "체크인/체크아웃", "HTTPS\n브라우저")

' Web Application → REST API
Rel(webapp, api, "API 호출", "JSON/HTTPS\n- fetch()\n- axios")

' Web Application → Browser Storage
Rel(webapp, localStorage, "데이터 캐싱/읽기", "JavaScript\n- localStorage.setItem()\n- localStorage.getItem()")

' REST API → Supabase
Rel(api, supabase, "CRUD 작업", "REST API\n- SELECT\n- INSERT\n- UPDATE\n- DELETE")

' REST API → Resend
Rel(api, resend, "이메일 전송", "REST API\n- POST /emails")

' ============================================================================
' Notes
' ============================================================================

note right of webapp
  **기술 스택:**
  - Next.js 14.2 (App Router)
  - React 18.3
  - TypeScript 5.4
  - CSS Modules

  **주요 디렉토리:**
  - app/ (페이지)
  - components/ (UI 컴포넌트)
  - src/hooks/ (커스텀 훅)
  - lib/ (서비스 레이어)
end note

note right of api
  **주요 로직:**
  - 관리자 로그인 검증
  - 체크인 알림 발송
  - 개발 도구 API

  **환경 변수:**
  - SUPABASE_URL
  - SUPABASE_KEY
  - RESEND_API_KEY
end note

note right of localStorage
  **캐싱 전략:**
  - Fallback for offline
  - Session persistence

  **제한 사항:**
  - 5-10MB storage limit
  - Same-origin policy
end note

' ============================================================================
' 동기화 체크리스트
' ============================================================================
'
' □ 새로운 실행 단위 추가 시
'   - Container(...) 추가
'   - Rel(...) 관계 정의
'
' □ 컨테이너 간 관계 변경 시
'   - Rel(...) 수정
'
' □ 외부 시스템 변경 시
'   - System_Ext(...) 수정
'   - Rel(api, 외부시스템, ...) 수정
'
' □ 기술 스택 업데이트 시
'   - Container 설명 업데이트

@enduml
