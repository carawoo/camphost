@startuml CampHost Container Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

' ============================================================================
' Level 2: Container Diagram
' ============================================================================
'
' CampHost ì‹œìŠ¤í…œ ë‚´ë¶€ì˜ ì£¼ìš” ì»¨í…Œì´ë„ˆ(ì‹¤í–‰ ë‹¨ìœ„)ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤.
' - Web Application (Next.js)
' - REST API (Next.js API Routes)
' - Browser Storage (localStorage)
' - ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ê´€ê³„
'
' ğŸ”— ì´ì „ ë ˆë²¨: lv1-system-context/system.puml
' ğŸ”— ë‹¤ìŒ ë ˆë²¨: lv3-components/*.puml
' ============================================================================

LAYOUT_WITH_LEGEND()

title Container Diagram for CampHost

' ============================================================================
' Actors (ì‚¬ìš©ì)
' ============================================================================

Person(superAdmin, "Super Admin", "ì‹œìŠ¤í…œ ì „ì²´ ê´€ë¦¬ì")
Person(campgroundAdmin, "Campground Admin", "ìº í•‘ì¥ ì‚¬ì¥ë‹˜")
Person(camper, "Camper", "ìº í•‘ ê³ ê°")

' ============================================================================
' System Boundary
' ============================================================================

System_Boundary(camphost, "CampHost") {

    ' ------------------------------------------------------------------------
    ' Web Application
    ' ------------------------------------------------------------------------
    Container(webapp, "Web Application", "Next.js 14.2, React 18, TypeScript", "ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ì œê³µ\n\n**ì£¼ìš” í˜ì´ì§€:**\n- / (ëœë”© í˜ì´ì§€)\n- /super-admin/dashboard (ì „ì²´ ìº í•‘ì¥ ê´€ë¦¬)\n- /admin/* (ëŒ€ì‹œë³´ë“œ, ì˜ˆì•½, ë§¤ì¶œ, ê°ì‹¤, í†µê³„, ë¬¸ì˜, ì„¤ì •)\n- /kiosk (ë¬´ì¸ ì²´í¬ì¸/ì²´í¬ì•„ì›ƒ)\n\n**ì•„í‚¤í…ì²˜ êµ¬ì„±:**\n- UI Components (Super Admin, Admin, Kiosk, Landing)\n- Custom Hooks (useCampgrounds, useReservations, useAuth, useForm, useFilteredData, useLocalStorage)\n- Service Layer (Legacy í•¨ìˆ˜í˜• + Modern í´ë˜ìŠ¤ ê¸°ë°˜)\n- Shared Components (QRCodeGenerator ë“±)\n\n**ë Œë”ë§:**\n- SSR (Server-Side Rendering)\n- SSG (Static Site Generation)\n- CSR (Client-Side Rendering)")

    ' ------------------------------------------------------------------------
    ' REST API
    ' ------------------------------------------------------------------------
    Container(api, "REST API", "Next.js API Routes, Node.js", "ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ì™¸ë¶€ ì„œë¹„ìŠ¤ í†µí•©\n\n**ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸:**\n- POST /api/admin/login (ê´€ë¦¬ì ì¸ì¦)\n- POST /api/notify/checkin (ì²´í¬ì¸ ì•Œë¦¼)\n- POST /api/admin/reset-email (ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •)\n- POST /api/admin/help-email (ë¬¸ì˜ ì´ë©”ì¼)\n- GET /api/dev/seed-reservation (í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±)\n- GET /api/dev/cascade-delete (ìºìŠ¤ì¼€ì´ë“œ ì‚­ì œ)\n\n**ì—­í• :**\n- ì¸ì¦ ë° ê¶Œí•œ ê²€ì¦ (Supabase ìº í•‘ì¥ ì¡°íšŒ, ë¹„ë°€ë²ˆí˜¸ ê²€ì¦)\n- Supabase ë°ì´í„° ì ‘ê·¼ (CRUD)\n- Resend ì´ë©”ì¼ ë°œì†¡ (Plain Text + HTML Template)\n- ê°œë°œ ë„êµ¬ (í…ŒìŠ¤íŠ¸ ë°ì´í„°, ì‚­ì œ)")

    ' ------------------------------------------------------------------------
    ' Browser Storage
    ' ------------------------------------------------------------------------
    ContainerDb(localStorage, "Browser Storage", "localStorage", "ì˜¤í”„ë¼ì¸ ì§€ì› ë° ë°ì´í„° ìºì‹±\n\n**ì €ì¥ ë°ì´í„°:**\n- ìº í•‘ì¥ ëª©ë¡ (ì „ì²´ ìº í•‘ì¥ ê´€ë¦¬)\n- ì˜ˆì•½ ì •ë³´ (í´ë°±)\n- ì‚¬ìš©ì ì„¸ì…˜ (ë¡œê·¸ì¸ ìƒíƒœ)\n- ë‹¨ì¼ ìº í•‘ì¥ ì •ë³´\n\n**ì ‘ê·¼ ë°©ë²•:**\n- StorageManager (Modern Services)\n- ì§ì ‘ ì ‘ê·¼ (Legacy Services)\n- useLocalStorage Hook\n\n**ì‚¬ìš© ì‹œì :**\n- ì˜¤í”„ë¼ì¸ ëª¨ë“œ\n- ë„¤íŠ¸ì›Œí¬ ì¥ì•  ì‹œ\n- ì´ˆê¸° ë°ì´í„° ë¡œë”© (ìƒ˜í”Œ ë°ì´í„°)")

}

' ============================================================================
' External Systems (ì™¸ë¶€ ì‹œìŠ¤í…œ)
' ============================================================================

System_Ext(supabase, "Supabase", "PostgreSQL ë°ì´í„°ë² ì´ìŠ¤\n\n**í…Œì´ë¸”:**\n- campgrounds (ìº í•‘ì¥ ì •ë³´)\n- reservations (ì˜ˆì•½ ì •ë³´)\n- inquiries (ë¬¸ì˜ ì‚¬í•­)\n- dashboard_metrics (view, ëŒ€ì‹œë³´ë“œ í†µê³„)\n\n**ì ‘ê·¼ ë°©ë²•:**\n- Supabase REST Helper (ê²½ëŸ‰ êµ¬í˜„)\n- ì§ì ‘ REST API í˜¸ì¶œ")

System_Ext(resend, "Resend", "ì´ë©”ì¼ ë°œì†¡ ì„œë¹„ìŠ¤\n\n**ì´ë©”ì¼ ì¢…ë¥˜:**\n- ì²´í¬ì¸ ì•Œë¦¼ (Plain Text)\n- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • (HTML Template)\n- íšŒì›ì •ë³´ ë¬¸ì˜ (HTML Template)\n\n**ìˆ˜ì‹ ì:**\n- NOTIFY_EMAIL í™˜ê²½ ë³€ìˆ˜")

' ============================================================================
' Relationships (ê´€ê³„)
' ============================================================================

' Users â†’ Web Application
Rel(superAdmin, webapp, "ìº í•‘ì¥ ê´€ë¦¬", "HTTPS\në¸Œë¼ìš°ì €")
Rel(campgroundAdmin, webapp, "ì˜ˆì•½ ê´€ë¦¬", "HTTPS\në¸Œë¼ìš°ì €")
Rel(camper, webapp, "ì²´í¬ì¸/ì²´í¬ì•„ì›ƒ", "HTTPS\në¸Œë¼ìš°ì €")

' Web Application â†’ REST API
Rel(webapp, api, "API í˜¸ì¶œ", "JSON/HTTPS\n- fetch()\n- axios")

' Web Application â†’ Browser Storage
Rel(webapp, localStorage, "ë°ì´í„° ìºì‹±/ì½ê¸°", "JavaScript\n- localStorage.setItem()\n- localStorage.getItem()")

' REST API â†’ Supabase
Rel(api, supabase, "CRUD ì‘ì—…", "REST API\n- SELECT\n- INSERT\n- UPDATE\n- DELETE")

' REST API â†’ Resend
Rel(api, resend, "ì´ë©”ì¼ ì „ì†¡", "REST API\n- POST /emails")

' ============================================================================
' Notes
' ============================================================================

note right of webapp
  **ê¸°ìˆ  ìŠ¤íƒ:**
  - Next.js 14.2 (App Router)
  - React 18.3
  - TypeScript 5.4
  - CSS Modules

  **ì£¼ìš” ë””ë ‰í† ë¦¬:**
  - app/ (í˜ì´ì§€: Super Admin, Admin, Kiosk, Landing)
  - components/ (Shared Components: QRCodeGenerator ë“±)
  - src/hooks/ (Custom Hooks: ë°ì´í„° ê´€ë¦¬ ë¡œì§)
  - lib/ (Legacy Services: í•¨ìˆ˜í˜•)
  - src/services/ (Modern Services: í´ë˜ìŠ¤ ê¸°ë°˜)
  - src/utils/ (Utilities: StorageManager, DateUtils ë“±)

  **ì•„í‚¤í…ì²˜ íŒ¨í„´:**
  - Legacy (í•¨ìˆ˜í˜•) + Modern (í´ë˜ìŠ¤ ê¸°ë°˜) ê³µì¡´
  - ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ (lib/ â†’ src/services/)
  - Custom Hooksë¡œ ìƒíƒœ ê´€ë¦¬

  **ìƒì„¸ êµ¬ì¡°:**
  â†’ lv3-components/webapp.puml
  â†’ lv3-components/services.puml
end note

note right of api
  **ì£¼ìš” API ì»´í¬ë„ŒíŠ¸:**
  - Admin Login API (POST /api/admin/login)
    â€¢ Supabase ìº í•‘ì¥ ì¡°íšŒ ë° ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
    â€¢ ì‚­ì œëœ ìº í•‘ì¥ ì°¨ë‹¨
    â€¢ í´ë°±: í•˜ë“œì½”ë”© credential

  - Checkin Notification API (POST /api/notify/checkin)
    â€¢ ì²´í¬ì¸ ì •ë³´ ìˆ˜ì‹ 
    â€¢ Resend ì´ë©”ì¼ ë°œì†¡

  - Email APIs (reset-email, help-email)
    â€¢ HTML Template ê¸°ë°˜ ì´ë©”ì¼

  - Dev Tools API (seed-reservation, cascade-delete)
    â€¢ í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ë° ì‚­ì œ

  **í™˜ê²½ ë³€ìˆ˜:**
  - SUPABASE_URL, SUPABASE_KEY
  - RESEND_API_KEY
  - NOTIFY_EMAIL

  **ìƒì„¸ êµ¬ì¡°:**
  â†’ lv3-components/api.puml
end note

note right of localStorage
  **ì €ì¥ ë°ì´í„°:**
  - ìº í•‘ì¥ ëª©ë¡ (ì „ì²´/ë‹¨ì¼)
  - ì˜ˆì•½ ì •ë³´
  - ì‚¬ìš©ì ì„¸ì…˜

  **ì ‘ê·¼ ë ˆì´ì–´:**
  - StorageManager (Modern, SSR ëŒ€ì‘)
  - ì§ì ‘ ì ‘ê·¼ (Legacy)
  - useLocalStorage Hook

  **ìºì‹± ì „ëµ:**
  - Fallback for offline
  - Session persistence
  - ì´ˆê¸° ìƒ˜í”Œ ë°ì´í„° ì œê³µ

  **ì œí•œ ì‚¬í•­:**
  - 5-10MB storage limit
  - Same-origin policy

  **ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ:**
  - localStorage ìš°ì„  â†’ Supabase ë™ê¸°í™”
end note

' ============================================================================
' ë™ê¸°í™” ì²´í¬ë¦¬ìŠ¤íŠ¸
' ============================================================================
'
' â–¡ ìƒˆë¡œìš´ ì‹¤í–‰ ë‹¨ìœ„ ì¶”ê°€ ì‹œ
'   - Container(...) ì¶”ê°€
'   - Rel(...) ê´€ê³„ ì •ì˜
'   - Noteì— ê¸°ìˆ  ìŠ¤íƒ ë° ì—­í•  ì„¤ëª…
'
' â–¡ ì»¨í…Œì´ë„ˆ ê°„ ê´€ê³„ ë³€ê²½ ì‹œ
'   - Rel(...) ìˆ˜ì •
'   - Level 3 Component ë‹¤ì´ì–´ê·¸ë¨ í™•ì¸ ë° ë™ê¸°í™”
'
' â–¡ ì™¸ë¶€ ì‹œìŠ¤í…œ ë³€ê²½ ì‹œ
'   - System_Ext(...) ìˆ˜ì •
'   - Rel(api, ì™¸ë¶€ì‹œìŠ¤í…œ, ...) ìˆ˜ì •
'   - Level 3 API Component ë‹¤ì´ì–´ê·¸ë¨ í™•ì¸
'
' â–¡ ê¸°ìˆ  ìŠ¤íƒ ì—…ë°ì´íŠ¸ ì‹œ
'   - Container ì„¤ëª… ì—…ë°ì´íŠ¸ (ì£¼ìš” í˜ì´ì§€, ì—”ë“œí¬ì¸íŠ¸)
'   - Noteì— ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸ ì •ë³´ ë°˜ì˜
'
' â–¡ ì•„í‚¤í…ì²˜ íŒ¨í„´ ë³€ê²½ ì‹œ
'   - Web Applicationì˜ Service Layer êµ¬ì¡° ì—…ë°ì´íŠ¸
'   - Legacy vs Modern ì•„í‚¤í…ì²˜ ë¹„ìœ¨ í™•ì¸
'   - Level 3 services.puml ë™ê¸°í™”
'
' â–¡ Level 3 ë‹¤ì´ì–´ê·¸ë¨ ë³€ê²½ ì‹œ
'   - webapp.puml ë³€ê²½ â†’ Container ì„¤ëª… ë° Note ì—…ë°ì´íŠ¸
'   - api.puml ë³€ê²½ â†’ API ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡ ë°˜ì˜
'   - services.puml ë³€ê²½ â†’ Service Layer êµ¬ì¡° í™•ì¸
'
' ============================================================================
' Level 2 â†” Level 3 ë™ê¸°í™” ë§¤í•‘
' ============================================================================
'
' Web Application Container
'   â†” lv3-components/webapp.puml (UI Components, Hooks, Service Layer)
'   â†” lv3-components/services.puml (Legacy + Modern Services)
'
' REST API Container
'   â†” lv3-components/api.puml (API ì—”ë“œí¬ì¸íŠ¸)
'
' Browser Storage Container
'   â†” lv3-components/webapp.puml (StorageManager)
'   â†” lv3-components/services.puml (Services â†’ localStorage ê´€ê³„)

@enduml
