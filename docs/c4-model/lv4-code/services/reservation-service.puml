@startuml Reservation Service - Level 4 Code
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

' ============================================================================
' CampHost - Reservation Service (Level 4: Code)
' ============================================================================
'
' ğŸ”— ì½”ë“œ ê²½ë¡œ: lib/reservations.ts
'
' ì˜ˆì•½ ë°ì´í„° ê´€ë¦¬ ìœ í‹¸ë¦¬í‹°
' - localStorage ê¸°ë°˜ ì˜ˆì•½ ë°ì´í„° CRUD
' - ì´ˆê¸° ìƒ˜í”Œ ë°ì´í„° ì œê³µ
' - ì˜ˆì•½ ê²€ìƒ‰ ê¸°ëŠ¥
'
' ============================================================================

title Reservation Service - Code Level

' íƒ€ì… ì •ì˜
class Reservation {
  + id: string
  + guestName: string
  + phone: string
  + roomNumber: string
  + checkInDate: string
  + checkOutDate: string
  + guests: number
  + totalAmount: number
  + status: 'confirmed' | 'checked-in' | 'checked-out'
  + createdAt: string
  + actualCheckinTime?: string
  + actualCheckoutTime?: string
}

note right of Reservation
  ì˜ˆì•½ ë°ì´í„° íƒ€ì…
  - status: ì˜ˆì•½ ìƒíƒœ (confirmed, checked-in, checked-out)
  - actualCheckinTime/actualCheckoutTime: ì‹¤ì œ ì²´í¬ì¸/ì•„ì›ƒ ì‹œê°„
end note

' ìƒìˆ˜
class Constants {
  + {static} STORAGE_KEY: string = 'odoichon_reservations'
  + {static} initialReservations: Reservation[]
}

note right of Constants
  - STORAGE_KEY: localStorage í‚¤
  - initialReservations: ì´ˆê¸° ìƒ˜í”Œ ë°ì´í„° (ê¹€ì² ìˆ˜, ì´ì˜í¬)
end note

' ì„œë¹„ìŠ¤ í•¨ìˆ˜ë“¤
package "Reservation Service Functions" {
  class ReservationService <<utility>> {
    + {static} getReservations(): Reservation[]
    + {static} saveReservations(reservations: Reservation[]): void
    + {static} addReservation(data: Omit<Reservation, 'id' | 'status' | 'createdAt'>): Reservation
    + {static} updateReservationStatus(id: string, status: Reservation['status']): boolean
    + {static} deleteReservation(id: string): boolean
    + {static} findReservation(guestName: string, phone: string): Reservation | null
  }
}

note bottom of ReservationService
  **ì£¼ìš” ë©”ì„œë“œ**:
  - getReservations(): localStorageì—ì„œ ì˜ˆì•½ ë°ì´í„° ë¡œë“œ (ì—†ìœ¼ë©´ ì´ˆê¸° ë°ì´í„°)
  - saveReservations(): localStorageì— ì˜ˆì•½ ë°ì´í„° ì €ì¥
  - addReservation(): ìƒˆ ì˜ˆì•½ ì¶”ê°€ (id, status, createdAt ìë™ ìƒì„±)
  - updateReservationStatus(): ì˜ˆì•½ ìƒíƒœ ì—…ë°ì´íŠ¸
  - deleteReservation(): ì˜ˆì•½ ì‚­ì œ
  - findReservation(): ì´ë¦„ê³¼ ì „í™”ë²ˆí˜¸ë¡œ ì˜ˆì•½ ê²€ìƒ‰

  **SSR ëŒ€ì‘**: typeof window === 'undefined' ì²´í¬
  **ì—ëŸ¬ ì²˜ë¦¬**: try-catchë¡œ localStorage ì ‘ê·¼ ì˜¤ë¥˜ ì²˜ë¦¬
end note

' ì™¸ë¶€ ì˜ì¡´ì„±
database localStorage {
  frame "Storage" {
    [odoichon_reservations]
  }
}

' ê´€ê³„
ReservationService --> Reservation : uses
ReservationService --> Constants : uses
ReservationService --> localStorage : read/write

' ë ˆì´ì•„ì›ƒ
Constants -[hidden]down- ReservationService
Reservation -[hidden]down- Constants

legend right
  **Level 4: Code - Reservation Service**

  **íŒŒì¼**: lib/reservations.ts
  **íƒ€ì…**: Utility Functions (Functional Programming)
  **ì €ì¥ì†Œ**: localStorage (Browser)

  **íŠ¹ì§•**:
  - í´ë˜ìŠ¤ ì—†ì´ í•¨ìˆ˜ ê¸°ë°˜ ì„¤ê³„
  - SSR(Server-Side Rendering) ì§€ì›
  - ì´ˆê¸° ìƒ˜í”Œ ë°ì´í„° ìë™ ìƒì„±
  - íƒ€ì… ì•ˆì „ì„± (TypeScript)

  **ì‚¬ìš© ì˜ˆì‹œ**:
  ```typescript
  // ì˜ˆì•½ ì¡°íšŒ
  const reservations = getReservations()

  // ì˜ˆì•½ ì¶”ê°€
  const newReservation = addReservation({
    guestName: 'ë°•ì˜ìˆ˜',
    phone: '010-1111-2222',
    roomNumber: 'Cë™-301',
    checkInDate: '2025-02-01',
    checkOutDate: '2025-02-03',
    guests: 3,
    totalAmount: 180000
  })

  // ì˜ˆì•½ ê²€ìƒ‰
  const found = findReservation('ê¹€ì² ìˆ˜', '010-1234-5678')

  // ìƒíƒœ ì—…ë°ì´íŠ¸
  updateReservationStatus('1', 'checked-in')
  ```
end legend

@enduml
